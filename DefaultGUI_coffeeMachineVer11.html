
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Event Selector</title>
        <style>
            .hidden {
                display: none;
            }
        </style>
    </head>
    <body>
        <h1>Event Selector</h1>
        <label for="eventSelector">Select Event:</label>
        <select id="eventSelector" onchange="updateParameters()">
            <option value="">--Select an Event--</option>
            <option value="insertCoinEvent">insertCoinEvent</option>
<option value="selectBeverageEvent">selectBeverageEvent</option>
<option value="selectSugarEvent">selectSugarEvent</option>
<option value="beverageTakenEvent">beverageTakenEvent</option>

        </select>

        <div id="parameters" class="hidden">
            <!-- Parameters will be dynamically added here -->
        </div>

        <button id="invokeButton" onclick="invokeEvent()">Invoke</button>
        <p id="resultLabel">Received: </p>

        <script>
            const socket = new WebSocket('ws://localhost:8001');
        
            socket.onopen = function() {
                console.log('WebSocket connection established');
            };
            socket.onmessage = function(eventMessage) {
                const event = JSON.parse(eventMessage.data);
                console.log('Received:', event);
                const resultLabel = document.getElementById('resultLabel');
                resultLabel.textContent += JSON.stringify(event) +"\n";
            };
            const eventParameters = {"insertCoinEvent": ["machineId"], "selectBeverageEvent": ["machineId", "beverage"], "selectSugarEvent": ["machineId", "sugarAmount"], "beverageTakenEvent": ["machineId"]};

            function updateParameters() {
                const eventSelector = document.getElementById('eventSelector');
                const selectedEvent = eventSelector.value;
                const parametersDiv = document.getElementById('parameters');
                parametersDiv.innerHTML = '';

                if (eventParameters[selectedEvent]) {
                    eventParameters[selectedEvent].forEach(param => {
                        const label = document.createElement('label');
                        label.textContent = param + ": ";
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.id = param;
                        parametersDiv.appendChild(label);
                        parametersDiv.appendChild(input);
                        parametersDiv.appendChild(document.createElement('br'));
                    });
                    parametersDiv.classList.remove('hidden');
                } else {
                    parametersDiv.classList.add('hidden');
                }
            }
            
            function invokeEvent() {
                const eventSelector = document.getElementById('eventSelector');
                const selectedEvent = eventSelector.value;
                if (!selectedEvent) {
                    alert('Please select an event');
                    return;
                }

                let params = {};
                if (eventParameters[selectedEvent]) {
                    eventParameters[selectedEvent].forEach(param => {
                        const value = document.getElementById(param).value;
                        if (!value) {
                            alert(`Please fill in the parameter: ${param}`);
                            return;
                        }
                        params[param] = value;
                    });
                }
                socket.send(JSON.stringify({ name: selectedEvent, data: params }));
                console.log(`${selectedEvent} ${JSON.stringify(params)}`);
            }
        </script>
    </body>
    </html>
    